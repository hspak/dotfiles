#!/bin/bash

vol_increm=5

toggle() {
  ponymix is-muted
  if [[ $? -ne 0 ]]; then
    ponymix mute > /dev/null
    echo 0
  else
    echo $(ponymix mute)
  fi
}

increase() {
  ponymix unmute &> /dev/null
  echo $(ponymix increase $vol_increm)
}

decrease() {
  ponymix unmute &> /dev/null
  echo $(ponymix decrease $vol_increm)
}

num_to_bar() {
  perc=$1
  jump=$2
  bar=""
  cnt=0
  while [[ $perc -gt 0 ]]; do
    ((perc=perc-jump))
    ((cnt++))
    bar="$bar◼"
  done
  while [[ $cnt -lt 20 ]]; do
    ((cnt++))
    bar="$bar◽"
  done
  bar="$bar  $1%"
  echo "$bar"
}

# check if input is a function
action=$1
type -t $action >/dev/null || exit 1

# only runs with an argument
[[ $# -gt 0 ]] && dunstify -r 1 -t 2 "Volume" "$(num_to_bar "$($action)" 5)"
